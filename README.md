# Expert System for Cloth Choice
人工智能A的Project，设计一个基于规则的专家系统。

[toc]

## 运行平台
- 64位 windows 10
- 开发环境为 Pycharm
- Python 版本 2.7
- 浏览器 chrome，未测试IE兼容性



## 项目文件
```
ExpertSystem
├── docs                # 文档
├── engine              # 专家系统核心逻辑 	
│	├── Explain.py            # 解释设备
│	├── GenerateFacts.py      # 构建数据库
│	├── Infer.py              # 前向链接及冲突消解
│	└── Interaction.py        # 前后台交互以及知识库管理
├── rules               # 知识库 	
│	├── backup                # 备份规则
│	├── GetRules.ipynb        # 从rules.txt生成rule.default.json
│	├── rules.default.json    # 当前使用的规则
│	└── rules.txt             # 当前使用规则的文本格式
├── static               # Web静态文件		
├── templates            # 网页模板
│	└── index.html            # index主页
├── app.py               # app运行文件		
└── README.md		# README
```




## 运行方式

1. 在主目录下使用 Python 2.7 运行 app.py 文件
2. 按照输出信息，用chrome浏览器打开[http://127.0.0.1:5000/](http://127.0.0.1:5000/)


## 功能说明
该专家系统的用户界面主要由三部分组成：穿衣指南、专家解释和知识库管理
分别对应专家系统的数据库、解释设备和知识库三部分逻辑
详细文档可见[doc](docs/doc.pdf)

### 穿衣指南
穿衣指南分成两部分，左侧用户录入信息，右侧系统根据用户提供的信息提供建议

- 用户信息
    - 天气情况：必填项
        - 天气：晴朗/阴天/下雨，默认晴朗
        - 气温：不能为空，必须输入数字，且范围-100~100之间
        - 湿度：干燥/正常/潮湿，默认正常
        - 风力：小/正常/大，默认正常
    - 个性定制：选填项，默认为空
        - 性别：男/女
        - 对温度的敏感程度：一般/怕冷
        - 衣物风格：正式/休闲
- 专家建议
    - 首先根据天气情况判断此时的穿衣指数，得到当季服装
    - 再根据个性定制，对当季服装进行筛选，得到最后的衣物推荐



### 专家解释
专家解释提供结论的推理过程，左侧显示知识库匹配的规则，右侧显示推理解释

- 规则匹配：按照规则激活的顺序显示规则，每条规则包括规则编号、规则前项、规则后项和对该规则的描述
- 规则描述：根据预先设置的解释系统，对推理的整体过程进行解释
    - 首先得出着装指数
    - 根据着装指数和个性定制选择衣物
    - 个性定制的选项和衣物选择考虑的因素进行对应，在衣物选择过程中没有用到的定制信息将不被显示



### 知识库管理
知识库管理是为了方便查看、添加、删除、修改知识库中规则，为用户提供的接口
但是，为了专家系统最基本功能的运行，用户无法删除或修改前24条规则
前24条规则属于知识库的最基本规则，从天气情况推断出着装指数
如果需要修改，必须由专人直接修改rules/rules.txt文件

#### 查看规则
读取rule.txt并显示所有的规则。

- 查看整个知识库的信息。
- 修改和删除需要通过该功能查看的规则ID。
- 所有操作结束之后将自动跳转到该页面，显示最新知识库状态


#### 添加规则
向知识库中增加一条规则，条件、结论和描述分别和规则匹配部分IF, THEN, Because相对应。

- 规则不需要创建ID编号，系统自动编号。
- 规则的条件以中文逗号"，"分隔，条件之间是AND关系。
    - 如果需要实现OR逻辑，则需要将条件拆分成多个规则，分别插入
- 规则的结论是需要添加的衣物，使用中文顿号"、"分隔
    - 如果衣物个数等于1，则表示满足该条件时，向已有衣物集合添加该衣物
    - 如果衣物个数大于1，则表示满足该条件时，和已有衣物集合求交集
    - 如果需要添加多个衣物，则可以将该规则拆分成多个规则，每个规则添加一件
    - 如果需要从已有集合中删除衣物，可以使用一个较小的衣物集合作为结论
- 规则的描述：从规则前项到规则后项的解释

#### 删除规则
从知识库中删除一条规则。

- 需要提供规则ID，可以通过查看功能首先定位到需要删除的规则ID，然后再进行删除。
- 删除一条规则之后，其后的规则ID依次减1，因此在删除前后规则ID会发生改变。
- 为了保证安全，每次只能删除一条规则。
- 多次删除，需要每次都需要查看确认ID。


#### 修改规则
修改知识库中的规则。

- 需要提供规则的ID，可以通查看功能定位。
- 修改功能将使用新的规则覆盖原有规则，规则的编号保持不变。
- 如果只修改规则的一部分，如条件，则不填写结论和解释即可。




## 依赖说明

1. Bootstrap前端框架：相关css/js等素材文件均在static下
2. Flask轻量级Web应用框架，可以通过pip获得
    `$ pip install Flask`


## 参考文献
